{% extends "base.html" %}

{% block content %}
<h2>Participations – {{ academic_ue.wording }} ({{ academic_ue.academicYear }})</h2>

<form method="POST">
    {% csrf_token %}
    {% for row in session_data %}
        <h3>Session du {{ row.session.jour }}/{{ row.session.mois }}</h3>
        <table border="1" cellpadding="5">
            <thead>
                <tr>
                    <th>Étudiant</th>
                    <th>Statut</th>
                </tr>
            </thead>
            <tbody>
                {% for item in row.participations %}
                    <tr>
                        <td>{{ item.student.first_name }} {{ item.student.last_name }}</td>
                        <td>
                            <select name="status_{{ row.session.id }}_{{ item.student.id }}">
                                <option value="" {% if not item.participation %}selected{% endif %}>Choisir...</option>
                                {% for code, label in status_choices %}
                                    <option value="{{ code }}" {% if item.participation and item.participation.status == code %}selected{% endif %}>
                                        {{ label }}
                                    </option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endfor %}

    <button type="submit">Enregistrer les modifications</button>
</form>

    <p>
        <a href="{% url 'students_in_academic_ue' academic_ue_id=academic_ue.idUE %}">
            ← Retour à la liste des étudiants pour {{ academic_ue.wording }} ({{ academic_ue.academicYear }}, Cycle {{ academic_ue.yearCycle }})
        </a>
    </p>
{% endblock %}
